import{j as e}from"./ui-vendor-CXejv-Vd.js";import{r as t,j as s,l as a}from"./react-vendor-CHV_IW2N.js";import{B as i,t as n}from"./index-Cr6N7EBb.js";import{T as r}from"./textarea-BYPke34D.js";import{T as l,a as o,b as c,c as d}from"./tabs-kE7gD3tv.js";import{M as m}from"./MarkdownRenderer-Lw0kgnVa.js";import{bm as u,bn as g,bo as x,bp as h,bq as p,br as b,bs as j,bt as v,bu as f,ax as y,bv as N,be as w,aO as C,o as k,J as S,ai as E}from"./utils-vendor-D0ROWCy7.js";import"./charts-vendor-CfJeLvg-.js";import"./i18n-vendor-p0y8CAKE.js";const B=({value:s,onChange:a,height:n=400,placeholder:k="Start writing..."})=>{const[S,E]=t.useState("write"),B=t.useRef(null),L=t.useCallback((e,t="",i="")=>{const n=B.current;if(!n)return;const r=n.selectionStart,l=n.selectionEnd,o=s.substring(r,l)||i,c=s.substring(0,r)+e+o+t+s.substring(l);a(c),setTimeout(()=>{n.focus();const t=r+e.length+o.length;n.setSelectionRange(t,t)},0)},[s,a]),T=t.useCallback(()=>{const e=prompt("Enter URL:");if(e){const t=prompt("Enter link text:",e);L(`[${t||e}](`,")")}},[L]),H=t.useCallback(()=>{if(prompt("Enter image URL:")){const e=prompt("Enter alt text:","Image");L(`![${e}](`,")")}},[L]),R=t.useCallback(()=>{const e=["compound-interest","mortgage","loan","investment","retirement","bmi","percentage","currency","tip"],t=prompt(`Enter calculator type (${e.join(", ")}):`,"compound-interest");if(t&&e.includes(t)){L(`\n\n[CALCULATOR:${t}]\n\n`,"")}},[L]),P=[{icon:u,action:()=>L("# ","","Heading 1"),title:"Heading 1"},{icon:g,action:()=>L("## ","","Heading 2"),title:"Heading 2"},{icon:x,action:()=>L("### ","","Heading 3"),title:"Heading 3"},{icon:h,action:()=>L("**","**","bold text"),title:"Bold"},{icon:p,action:()=>L("_","_","italic text"),title:"Italic"},{icon:b,action:()=>L("`","`","code"),title:"Inline Code"},{icon:j,action:()=>L("> ","","blockquote"),title:"Quote"},{icon:v,action:()=>L("- ","","list item"),title:"Bullet List"},{icon:f,action:()=>L("1. ","","list item"),title:"Numbered List"},{icon:y,action:T,title:"Link"},{icon:N,action:H,title:"Image"},{icon:w,action:R,title:"Calculator"}];return e.jsx("div",{className:"border rounded-lg overflow-hidden",children:e.jsxs(l,{value:S,onValueChange:e=>E(e),children:[e.jsxs("div",{className:"flex items-center justify-between border-b bg-gray-50 px-3 py-2",children:[e.jsx("div",{className:"flex flex-wrap gap-1",children:P.map((t,s)=>e.jsx(i,{variant:"ghost",size:"sm",onClick:t.action,title:t.title,className:"h-8 w-8 p-0",children:e.jsx(t.icon,{className:"h-4 w-4"})},s))}),e.jsxs(o,{className:"h-8",children:[e.jsx(c,{value:"write",className:"text-xs",children:"Write"}),e.jsxs(c,{value:"preview",className:"text-xs",children:[e.jsx(C,{className:"h-3 w-3 mr-1"}),"Preview"]})]})]}),e.jsx(d,{value:"write",className:"m-0",children:e.jsx(r,{ref:B,value:s,onChange:e=>a(e.target.value),placeholder:k,className:"border-0 rounded-none resize-none focus-visible:ring-0",style:{height:n}})}),e.jsx(d,{value:"preview",className:"m-0",children:e.jsx("div",{className:"p-4 prose prose-sm max-w-none overflow-auto",style:{height:n},children:s?e.jsx(m,{content:s}):e.jsx("p",{className:"text-gray-500 italic",children:"Nothing to preview yet..."})})})]})})};function L(){const{id:i}=s(),r=a(),l="new"===i,[o,c]=t.useState(""),[d,m]=t.useState(""),[u,g]=t.useState(""),[x,h]=t.useState(""),[p,b]=t.useState(""),[j,v]=t.useState(!1),[f,y]=t.useState(!1),[N,w]=t.useState(!1),[C,L]=t.useState("");t.useEffect(()=>{!l&&i&&T()},[i]);const T=async()=>{try{y(!0);const e=await n.blog.get({slug:i});c(e.title),m(e.slug),g(e.content),h(e.excerpt||""),b(e.author||""),v(e.published)}catch(e){L("Failed to load blog post"),console.error(e)}finally{y(!1)}};return f?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx(k,{className:"w-8 h-8 animate-spin text-indigo-600"})}):e.jsx("div",{className:"min-h-screen bg-gray-50 py-8 px-4",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("button",{onClick:()=>r("/admin/blog"),className:"inline-flex items-center text-indigo-600 hover:text-indigo-700",children:[e.jsx(S,{className:"w-4 h-4 mr-2"}),"Back to Blog Management"]})}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-6",children:l?"New Blog Post":"Edit Blog Post"}),C&&e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded mb-4",children:C}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Title *"}),e.jsx("input",{type:"text",value:o,onChange:e=>{return t=e.target.value,c(t),void(l&&!d&&m(t.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-|-$/g,"")));var t},className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",placeholder:"Enter post title"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Slug *"}),e.jsx("input",{type:"text",value:d,onChange:e=>m(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",placeholder:"post-url-slug"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Excerpt"}),e.jsx("textarea",{value:x,onChange:e=>h(e.target.value),rows:3,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",placeholder:"Brief description"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Content *"}),e.jsx(B,{value:u,onChange:g,height:500,placeholder:"Write your post content here..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Author"}),e.jsx("input",{type:"text",value:p,onChange:e=>b(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",placeholder:"Author name"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"published",checked:j,onChange:e=>v(e.target.checked),className:"w-4 h-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500"}),e.jsx("label",{htmlFor:"published",className:"ml-2 text-sm text-gray-700",children:"Published"})]}),e.jsx("div",{className:"flex justify-end pt-4",children:e.jsxs("button",{onClick:async()=>{if(o&&d&&u)try{w(!0),L(""),l?await n.blog.create({title:o,slug:d,content:u,excerpt:x||void 0,author:p||void 0,published:j}):await n.blog.update({slug:i,title:o,content:u,excerpt:x||void 0,author:p||void 0,published:j}),r("/admin/blog")}catch(e){L(e.message||"Failed to save post"),console.error(e)}finally{w(!1)}else L("Title, slug, and content are required")},disabled:N,className:"inline-flex items-center px-6 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 disabled:opacity-50",children:[N?e.jsx(k,{className:"w-4 h-4 mr-2 animate-spin"}):e.jsx(E,{className:"w-4 h-4 mr-2"}),N?"Saving...":"Save Post"]})})]})]})]})})}export{L as default};
