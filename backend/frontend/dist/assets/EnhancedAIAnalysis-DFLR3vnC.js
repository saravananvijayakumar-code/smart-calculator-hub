import{j as e}from"./ui-vendor-CXejv-Vd.js";import{r as s}from"./react-vendor-CHV_IW2N.js";import{a,e as r,B as t,b as l,c as d,t as n}from"./index-Cr6N7EBb.js";import{B as i}from"./badge-BR8KeZ6e.js";import{o,l as c,v as m,S as x,t as h,T as g,w as b,p as u,u as j,al as p}from"./utils-vendor-D0ROWCy7.js";function N({calculatorType:N,data:f,userContext:y,onAnalysisComplete:w,className:v=""}){const[k,I]=s.useState(null),[A,M]=s.useState(!1),[S,T]=s.useState(null),C=s.useRef(null),Z=s.useRef(""),G=async()=>{M(!0),T(null);try{console.log("Calling AI analysis with:",{calculatorType:N,data:f,userContext:y});const e=await n.ai_analysis.analyze({calculatorType:N,data:f,userContext:y});if(console.log("AI Analysis result:",e),!e)return console.error("No result received from AI analysis"),void T("No analysis data received. Please try again.");if(!(e.summary||e.recommendations&&0!==e.recommendations.length))return console.error("Empty analysis received:",e),void T("Received empty analysis. Please try again.");I(e),null==w||w(e)}catch(e){console.error("AI Analysis error:",e),T(`Failed to generate analysis: ${e instanceof Error?e.message:"Unknown error"}. Please try again.`)}finally{M(!1)}};s.useEffect(()=>{const e=JSON.stringify({calculatorType:N,data:f,userContext:y});if(e!==Z.current)return Z.current=e,C.current&&clearTimeout(C.current),C.current=setTimeout(()=>{G()},1500),()=>{C.current&&clearTimeout(C.current)}},[N,JSON.stringify(f),JSON.stringify(y)]);const z=s=>{switch(s){case"optimization":return e.jsx(g,{className:"h-5 w-5"});case"warning":return e.jsx(c,{className:"h-5 w-5"});case"opportunity":return e.jsx(h,{className:"h-5 w-5"});case"risk":return e.jsx(p,{className:"h-5 w-5"});default:return e.jsx(j,{className:"h-5 w-5"})}};return A?e.jsx(a,{className:`border-0 bg-gradient-to-br from-indigo-500 via-purple-500 to-pink-500 text-white ${v}`,children:e.jsxs(r,{className:"flex flex-col items-center justify-center py-16",children:[e.jsxs("div",{className:"relative mb-6",children:[e.jsx("div",{className:"absolute inset-0 bg-white/30 rounded-full blur-2xl animate-pulse"}),e.jsx(o,{className:"h-16 w-16 animate-spin text-white drop-shadow-lg relative z-10"})]}),e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx("p",{className:"font-bold text-2xl drop-shadow-md",children:"Generating AI Analysis..."}),e.jsx("p",{className:"text-white/80 text-sm",children:"Analyzing your data with advanced AI models"}),e.jsxs("div",{className:"flex items-center justify-center gap-2 mt-6",children:[e.jsx("div",{className:"w-2 h-2 bg-white rounded-full animate-bounce",style:{animationDelay:"0ms"}}),e.jsx("div",{className:"w-2 h-2 bg-white rounded-full animate-bounce",style:{animationDelay:"150ms"}}),e.jsx("div",{className:"w-2 h-2 bg-white rounded-full animate-bounce",style:{animationDelay:"300ms"}})]})]})]})}):S?e.jsx(a,{className:`border-0 bg-gradient-to-br from-red-500 to-rose-600 text-white ${v}`,children:e.jsx(r,{className:"py-8",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"p-4 bg-white/20 backdrop-blur-sm rounded-full",children:e.jsx(c,{className:"h-12 w-12"})})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-xl mb-2",children:"Analysis Failed"}),e.jsx("p",{className:"text-white/90",children:S})]}),e.jsxs(t,{onClick:G,className:"bg-white text-red-600 hover:bg-white/90 shadow-lg hover:shadow-xl transition-all",size:"lg",children:[e.jsx(m,{className:"h-4 w-4 mr-2"}),"Try Again"]})]})})}):e.jsxs("div",{className:`space-y-6 ${v}`,children:[e.jsxs(a,{className:"border-0 bg-gradient-to-br from-violet-600 via-purple-600 to-indigo-600 text-white overflow-hidden relative",children:[e.jsx("div",{className:"absolute inset-0 bg-[url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjAiIGhlaWdodD0iNjAiIHZpZXdCb3g9IjAgMCA2MCA2MCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZyBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPjxnIGZpbGw9IiNmZmZmZmYiIGZpbGwtb3BhY2l0eT0iMC4wNSI+PHBhdGggZD0iTTM2IDM0djItMnptMCAzdjItMnptLTIgMGgyLTJ6bTAgMGgyLTJ6bS0yIDBoMi0yem0wLTNoMi0yem0yIDB2Mi0yem0wLTN2Mi0yem0tMiAwaDItMnoiLz48L2c+PC9nPjwvc3ZnPg==')] opacity-10"}),e.jsx(l,{className:"relative z-10",children:e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"p-2 bg-white/20 backdrop-blur-sm rounded-xl",children:e.jsx(m,{className:"h-6 w-6"})}),e.jsx(d,{className:"text-2xl font-bold",children:"AI Analysis Summary"}),e.jsx("div",{className:"ml-auto",children:e.jsxs(i,{className:"bg-white/20 backdrop-blur-sm border-white/30 text-white",children:[e.jsx(x,{className:"w-3 h-3 mr-1"}),"AI Generated"]})})]})}),e.jsx(r,{className:"relative z-10",children:e.jsx("p",{className:"text-white/95 leading-relaxed text-lg",children:null==k?void 0:k.summary})})]}),(null==k?void 0:k.recommendations)&&k.recommendations.length>0&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(h,{className:"h-6 w-6 text-primary"}),e.jsx("h3",{className:"text-2xl font-bold",children:"Personalized Recommendations"})]}),k.recommendations.map((s,t)=>{const l=(e=>{switch(e){case"high":return{badge:"bg-gradient-to-r from-red-500 to-pink-500 text-white border-0",card:"border-red-200 bg-gradient-to-br from-red-50 to-pink-50 dark:from-red-950/30 dark:to-pink-950/30",icon:"text-red-600 dark:text-red-400"};case"medium":return{badge:"bg-gradient-to-r from-orange-500 to-yellow-500 text-white border-0",card:"border-orange-200 bg-gradient-to-br from-orange-50 to-yellow-50 dark:from-orange-950/30 dark:to-yellow-950/30",icon:"text-orange-600 dark:text-orange-400"};case"low":return{badge:"bg-gradient-to-r from-green-500 to-emerald-500 text-white border-0",card:"border-green-200 bg-gradient-to-br from-green-50 to-emerald-50 dark:from-green-950/30 dark:to-emerald-950/30",icon:"text-green-600 dark:text-green-400"};default:return{badge:"bg-gradient-to-r from-gray-500 to-slate-500 text-white border-0",card:"border-gray-200 bg-gradient-to-br from-gray-50 to-slate-50 dark:from-gray-950/30 dark:to-slate-950/30",icon:"text-gray-600 dark:text-gray-400"}}})(s.priority);return e.jsx(a,{className:`${l.card} border-2 shadow-lg hover:shadow-xl transition-all duration-300 hover:scale-[1.02] overflow-hidden`,children:e.jsxs(r,{className:"p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-2.5 bg-white dark:bg-gray-900 rounded-xl shadow-md ${l.icon}`,children:z(s.type)}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-xl text-foreground",children:s.title}),s.estimatedImpact&&e.jsx("p",{className:"text-sm text-muted-foreground mt-0.5",children:s.estimatedImpact})]})]}),e.jsx(i,{className:`${l.badge} text-sm font-semibold px-3 py-1 shadow-md`,children:s.priority.toUpperCase()})]}),e.jsx("p",{className:"text-foreground/90 mb-4 leading-relaxed",children:s.description}),s.potentialSavings&&e.jsx("div",{className:"bg-gradient-to-r from-green-500 to-emerald-500 text-white rounded-xl p-4 mb-4 shadow-md",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(g,{className:"h-5 w-5"}),e.jsx("span",{className:"font-bold text-lg",children:"Potential Savings"})]}),e.jsxs("span",{className:"text-2xl font-bold",children:["$",s.potentialSavings.toLocaleString()]})]})}),s.actionItems.length>0&&e.jsxs("div",{className:"bg-white/50 dark:bg-gray-900/50 backdrop-blur-sm rounded-xl p-4 border border-white/60 dark:border-gray-700/60",children:[e.jsxs("h5",{className:"font-bold text-foreground mb-3 flex items-center gap-2",children:[e.jsx(b,{className:"h-4 w-4"}),"Action Items:"]}),e.jsx("ul",{className:"space-y-2.5",children:s.actionItems.map((s,a)=>e.jsxs("li",{className:"flex items-start gap-2.5 text-foreground/90",children:[e.jsx("div",{className:"mt-0.5 p-1 bg-primary/20 rounded-full",children:e.jsx(u,{className:"h-3.5 w-3.5 text-primary"})}),e.jsx("span",{className:"flex-1",children:s})]},a))})]})]})},t)})]}),(null==k?void 0:k.keyInsights)&&k.keyInsights.length>0&&e.jsxs(a,{className:"border-2 border-blue-200 bg-gradient-to-br from-blue-50 to-cyan-50 dark:from-blue-950/30 dark:to-cyan-950/30 shadow-lg",children:[e.jsx(l,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-500 text-white rounded-xl shadow-md",children:e.jsx(j,{className:"h-5 w-5"})}),e.jsx(d,{className:"text-2xl font-bold text-foreground",children:"Key Insights"})]})}),e.jsx(r,{children:e.jsx("ul",{className:"space-y-3",children:k.keyInsights.map((s,a)=>e.jsxs("li",{className:"flex items-start gap-3 p-3 bg-white/50 dark:bg-gray-900/50 backdrop-blur-sm rounded-lg border border-blue-200 dark:border-blue-800",children:[e.jsx(b,{className:"h-5 w-5 text-blue-600 dark:text-blue-400 mt-0.5 flex-shrink-0"}),e.jsx("span",{className:"text-foreground/90 leading-relaxed",children:s})]},a))})})]}),(null==k?void 0:k.riskFactors)&&k.riskFactors.length>0&&e.jsxs(a,{className:"border-2 border-orange-200 bg-gradient-to-br from-orange-50 to-red-50 dark:from-orange-950/30 dark:to-red-950/30 shadow-lg",children:[e.jsx(l,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-orange-500 text-white rounded-xl shadow-md",children:e.jsx(p,{className:"h-5 w-5"})}),e.jsx(d,{className:"text-2xl font-bold text-foreground",children:"Risk Factors"})]})}),e.jsx(r,{children:e.jsx("ul",{className:"space-y-3",children:k.riskFactors.map((s,a)=>e.jsxs("li",{className:"flex items-start gap-3 p-3 bg-white/50 dark:bg-gray-900/50 backdrop-blur-sm rounded-lg border border-orange-200 dark:border-orange-800",children:[e.jsx(c,{className:"h-5 w-5 text-orange-600 dark:text-orange-400 mt-0.5 flex-shrink-0"}),e.jsx("span",{className:"text-foreground/90 leading-relaxed",children:s})]},a))})})]}),(null==k?void 0:k.nextSteps)&&k.nextSteps.length>0&&e.jsxs(a,{className:"border-2 border-emerald-200 bg-gradient-to-br from-emerald-50 to-green-50 dark:from-emerald-950/30 dark:to-green-950/30 shadow-lg",children:[e.jsx(l,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-emerald-500 text-white rounded-xl shadow-md",children:e.jsx(g,{className:"h-5 w-5"})}),e.jsx(d,{className:"text-2xl font-bold text-foreground",children:"Next Steps"})]})}),e.jsx(r,{children:e.jsx("ul",{className:"space-y-3",children:k.nextSteps.map((s,a)=>e.jsxs("li",{className:"flex items-start gap-3 p-3 bg-white/50 dark:bg-gray-900/50 backdrop-blur-sm rounded-lg border border-emerald-200 dark:border-emerald-800 hover:bg-white/80 dark:hover:bg-gray-900/80 transition-colors",children:[e.jsx("div",{className:"p-1.5 bg-emerald-500 text-white rounded-full mt-0.5",children:e.jsx("span",{className:"text-xs font-bold",children:a+1})}),e.jsx("span",{className:"text-foreground/90 leading-relaxed flex-1",children:s}),e.jsx(u,{className:"h-5 w-5 text-emerald-600 dark:text-emerald-400 flex-shrink-0 mt-0.5"})]},a))})})]})]})}export{N as E};
