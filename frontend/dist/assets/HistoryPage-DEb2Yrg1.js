import{r as e,u as t,p as r,j as s,c as l,P as n,d as o,e as a,f as i,k as c,K as d}from"./ui-DlaF13aT.js";import{u}from"./calculatorStore-DzxD5LNT.js";import{l as h,p as m,q as p,r as x,s as f,t as g,T as v,u as j,f as w,B as b,X as y,v as N,w as S,b as C,I as T,x as E,y as A,z as R,E as L,J as k,K as D}from"./index-Bz8mWo3A.js";import{B as P}from"./badge-Yxso3t7Q.js";import{C as _}from"./checkbox-CC5C-E6-.js";import{S as z,a as O,b as H,c as M,d as I}from"./select-BDFQerag.js";import{T as W}from"./textarea-BSgKvqcc.js";import{S as U}from"./separator-p2zQO47H.js";import{C as F}from"./calendar-D5BWGOec.js";import{A as Y}from"./arrow-up-down-DYuLJe80.js";import{F as X}from"./funnel-wo6GB8oP.js";import{S as B}from"./star-CA9mt9VJ.js";import{T as $}from"./trash-2-BKaciHhd.js";import{S as V}from"./square-pen-Bw_IsG40.js";import{T as q}from"./tag-pMDEa9o9.js";import"./vendor-DjPCVcPo.js";import"./middleware-rUgv5aoa.js";import"./charts-DCG9Wh5P.js";import"./router-CpKuIDSt.js";import"./check-DuVLnFDe.js";
/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=h("ellipsis-vertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);var K="ScrollArea",[J]=l(K),[Q,G]=J(K),ee=e.forwardRef((l,o)=>{const{__scopeScrollArea:a,type:i="hover",dir:c,scrollHideDelay:d=600,...u}=l,[h,m]=e.useState(null),[p,x]=e.useState(null),[f,g]=e.useState(null),[v,j]=e.useState(null),[w,b]=e.useState(null),[y,N]=e.useState(0),[S,C]=e.useState(0),[T,E]=e.useState(!1),[A,R]=e.useState(!1),L=t(o,e=>m(e)),k=r(c);return s.jsx(Q,{scope:a,type:i,dir:k,scrollHideDelay:d,scrollArea:h,viewport:p,onViewportChange:x,content:f,onContentChange:g,scrollbarX:v,onScrollbarXChange:j,scrollbarXEnabled:T,onScrollbarXEnabledChange:E,scrollbarY:w,onScrollbarYChange:b,scrollbarYEnabled:A,onScrollbarYEnabledChange:R,onCornerWidthChange:N,onCornerHeightChange:C,children:s.jsx(n.div,{dir:k,...u,ref:L,style:{position:"relative","--radix-scroll-area-corner-width":y+"px","--radix-scroll-area-corner-height":S+"px",...l.style}})})});ee.displayName=K;var te="ScrollAreaViewport",re=e.forwardRef((r,l)=>{const{__scopeScrollArea:o,children:a,nonce:i,...c}=r,d=G(te,o),u=e.useRef(null),h=t(l,u,d.onViewportChange);return s.jsxs(s.Fragment,{children:[s.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:i}),s.jsx(n.div,{"data-radix-scroll-area-viewport":"",...c,ref:h,style:{overflowX:d.scrollbarXEnabled?"scroll":"hidden",overflowY:d.scrollbarYEnabled?"scroll":"hidden",...r.style},children:s.jsx("div",{ref:d.onContentChange,style:{minWidth:"100%",display:"table"},children:a})})]})});re.displayName=te;var se="ScrollAreaScrollbar",le=e.forwardRef((t,r)=>{const{forceMount:l,...n}=t,o=G(se,t.__scopeScrollArea),{onScrollbarXEnabledChange:a,onScrollbarYEnabledChange:i}=o,c="horizontal"===t.orientation;return e.useEffect(()=>(c?a(!0):i(!0),()=>{c?a(!1):i(!1)}),[c,a,i]),"hover"===o.type?s.jsx(ne,{...n,ref:r,forceMount:l}):"scroll"===o.type?s.jsx(oe,{...n,ref:r,forceMount:l}):"auto"===o.type?s.jsx(ae,{...n,ref:r,forceMount:l}):"always"===o.type?s.jsx(ie,{...n,ref:r}):null});le.displayName=se;var ne=e.forwardRef((t,r)=>{const{forceMount:l,...n}=t,a=G(se,t.__scopeScrollArea),[i,c]=e.useState(!1);return e.useEffect(()=>{const e=a.scrollArea;let t=0;if(e){const r=()=>{window.clearTimeout(t),c(!0)},s=()=>{t=window.setTimeout(()=>c(!1),a.scrollHideDelay)};return e.addEventListener("pointerenter",r),e.addEventListener("pointerleave",s),()=>{window.clearTimeout(t),e.removeEventListener("pointerenter",r),e.removeEventListener("pointerleave",s)}}},[a.scrollArea,a.scrollHideDelay]),s.jsx(o,{present:l||i,children:s.jsx(ae,{"data-state":i?"visible":"hidden",...n,ref:r})})}),oe=e.forwardRef((t,r)=>{const{forceMount:l,...n}=t,i=G(se,t.__scopeScrollArea),c="horizontal"===t.orientation,d=Ee(()=>h("SCROLL_END"),100),[u,h]=(m="hidden",p={hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}},e.useReducer((e,t)=>p[e][t]??e,m));var m,p;return e.useEffect(()=>{if("idle"===u){const e=window.setTimeout(()=>h("HIDE"),i.scrollHideDelay);return()=>window.clearTimeout(e)}},[u,i.scrollHideDelay,h]),e.useEffect(()=>{const e=i.viewport,t=c?"scrollLeft":"scrollTop";if(e){let r=e[t];const s=()=>{const s=e[t];r!==s&&(h("SCROLL"),d()),r=s};return e.addEventListener("scroll",s),()=>e.removeEventListener("scroll",s)}},[i.viewport,c,h,d]),s.jsx(o,{present:l||"hidden"!==u,children:s.jsx(ie,{"data-state":"hidden"===u?"hidden":"visible",...n,ref:r,onPointerEnter:a(t.onPointerEnter,()=>h("POINTER_ENTER")),onPointerLeave:a(t.onPointerLeave,()=>h("POINTER_LEAVE"))})})}),ae=e.forwardRef((t,r)=>{const l=G(se,t.__scopeScrollArea),{forceMount:n,...a}=t,[i,c]=e.useState(!1),d="horizontal"===t.orientation,u=Ee(()=>{if(l.viewport){const e=l.viewport.offsetWidth<l.viewport.scrollWidth,t=l.viewport.offsetHeight<l.viewport.scrollHeight;c(d?e:t)}},10);return Ae(l.viewport,u),Ae(l.content,u),s.jsx(o,{present:n||i,children:s.jsx(ie,{"data-state":i?"visible":"hidden",...a,ref:r})})}),ie=e.forwardRef((t,r)=>{const{orientation:l="vertical",...n}=t,o=G(se,t.__scopeScrollArea),a=e.useRef(null),i=e.useRef(0),[c,d]=e.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),u=be(c.viewport,c.content),h={...n,sizes:c,onSizesChange:d,hasThumb:Boolean(u>0&&u<1),onThumbChange:e=>a.current=e,onThumbPointerUp:()=>i.current=0,onThumbPointerDown:e=>i.current=e};function m(e,t){return function(e,t,r,s="ltr"){const l=ye(r),n=l/2,o=t||n,a=l-o,i=r.scrollbar.paddingStart+o,c=r.scrollbar.size-r.scrollbar.paddingEnd-a,d=r.content-r.viewport,u="ltr"===s?[0,d]:[-1*d,0];return Se([i,c],u)(e)}(e,i.current,c,t)}return"horizontal"===l?s.jsx(ce,{...h,ref:r,onThumbPositionChange:()=>{if(o.viewport&&a.current){const e=Ne(o.viewport.scrollLeft,c,o.dir);a.current.style.transform=`translate3d(${e}px, 0, 0)`}},onWheelScroll:e=>{o.viewport&&(o.viewport.scrollLeft=e)},onDragScroll:e=>{o.viewport&&(o.viewport.scrollLeft=m(e,o.dir))}}):"vertical"===l?s.jsx(de,{...h,ref:r,onThumbPositionChange:()=>{if(o.viewport&&a.current){const e=Ne(o.viewport.scrollTop,c);a.current.style.transform=`translate3d(0, ${e}px, 0)`}},onWheelScroll:e=>{o.viewport&&(o.viewport.scrollTop=e)},onDragScroll:e=>{o.viewport&&(o.viewport.scrollTop=m(e))}}):null}),ce=e.forwardRef((r,l)=>{const{sizes:n,onSizesChange:o,...a}=r,i=G(se,r.__scopeScrollArea),[c,d]=e.useState(),u=e.useRef(null),h=t(l,u,i.onScrollbarXChange);return e.useEffect(()=>{u.current&&d(getComputedStyle(u.current))},[u]),s.jsx(me,{"data-orientation":"horizontal",...a,ref:h,sizes:n,style:{bottom:0,left:"rtl"===i.dir?"var(--radix-scroll-area-corner-width)":0,right:"ltr"===i.dir?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":ye(n)+"px",...r.style},onThumbPointerDown:e=>r.onThumbPointerDown(e.x),onDragScroll:e=>r.onDragScroll(e.x),onWheelScroll:(e,t)=>{if(i.viewport){const s=i.viewport.scrollLeft+e.deltaX;r.onWheelScroll(s),Ce(s,t)&&e.preventDefault()}},onResize:()=>{u.current&&i.viewport&&c&&o({content:i.viewport.scrollWidth,viewport:i.viewport.offsetWidth,scrollbar:{size:u.current.clientWidth,paddingStart:we(c.paddingLeft),paddingEnd:we(c.paddingRight)}})}})}),de=e.forwardRef((r,l)=>{const{sizes:n,onSizesChange:o,...a}=r,i=G(se,r.__scopeScrollArea),[c,d]=e.useState(),u=e.useRef(null),h=t(l,u,i.onScrollbarYChange);return e.useEffect(()=>{u.current&&d(getComputedStyle(u.current))},[u]),s.jsx(me,{"data-orientation":"vertical",...a,ref:h,sizes:n,style:{top:0,right:"ltr"===i.dir?0:void 0,left:"rtl"===i.dir?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":ye(n)+"px",...r.style},onThumbPointerDown:e=>r.onThumbPointerDown(e.y),onDragScroll:e=>r.onDragScroll(e.y),onWheelScroll:(e,t)=>{if(i.viewport){const s=i.viewport.scrollTop+e.deltaY;r.onWheelScroll(s),Ce(s,t)&&e.preventDefault()}},onResize:()=>{u.current&&i.viewport&&c&&o({content:i.viewport.scrollHeight,viewport:i.viewport.offsetHeight,scrollbar:{size:u.current.clientHeight,paddingStart:we(c.paddingTop),paddingEnd:we(c.paddingBottom)}})}})}),[ue,he]=J(se),me=e.forwardRef((r,l)=>{const{__scopeScrollArea:o,sizes:c,hasThumb:d,onThumbChange:u,onThumbPointerUp:h,onThumbPointerDown:m,onThumbPositionChange:p,onDragScroll:x,onWheelScroll:f,onResize:g,...v}=r,j=G(se,o),[w,b]=e.useState(null),y=t(l,e=>b(e)),N=e.useRef(null),S=e.useRef(""),C=j.viewport,T=c.content-c.viewport,E=i(f),A=i(p),R=Ee(g,10);function L(e){if(N.current){const t=e.clientX-N.current.left,r=e.clientY-N.current.top;x({x:t,y:r})}}return e.useEffect(()=>{const e=e=>{const t=e.target;(null==w?void 0:w.contains(t))&&E(e,T)};return document.addEventListener("wheel",e,{passive:!1}),()=>document.removeEventListener("wheel",e,{passive:!1})},[C,w,T,E]),e.useEffect(A,[c,A]),Ae(w,R),Ae(j.content,R),s.jsx(ue,{scope:o,scrollbar:w,hasThumb:d,onThumbChange:i(u),onThumbPointerUp:i(h),onThumbPositionChange:A,onThumbPointerDown:i(m),children:s.jsx(n.div,{...v,ref:y,style:{position:"absolute",...v.style},onPointerDown:a(r.onPointerDown,e=>{if(0===e.button){e.target.setPointerCapture(e.pointerId),N.current=w.getBoundingClientRect(),S.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",j.viewport&&(j.viewport.style.scrollBehavior="auto"),L(e)}}),onPointerMove:a(r.onPointerMove,L),onPointerUp:a(r.onPointerUp,e=>{const t=e.target;t.hasPointerCapture(e.pointerId)&&t.releasePointerCapture(e.pointerId),document.body.style.webkitUserSelect=S.current,j.viewport&&(j.viewport.style.scrollBehavior=""),N.current=null})})})}),pe="ScrollAreaThumb",xe=e.forwardRef((e,t)=>{const{forceMount:r,...l}=e,n=he(pe,e.__scopeScrollArea);return s.jsx(o,{present:r||n.hasThumb,children:s.jsx(fe,{ref:t,...l})})}),fe=e.forwardRef((r,l)=>{const{__scopeScrollArea:o,style:i,...c}=r,d=G(pe,o),u=he(pe,o),{onThumbPositionChange:h}=u,m=t(l,e=>u.onThumbChange(e)),p=e.useRef(void 0),x=Ee(()=>{p.current&&(p.current(),p.current=void 0)},100);return e.useEffect(()=>{const e=d.viewport;if(e){const t=()=>{if(x(),!p.current){const t=Te(e,h);p.current=t,h()}};return h(),e.addEventListener("scroll",t),()=>e.removeEventListener("scroll",t)}},[d.viewport,x,h]),s.jsx(n.div,{"data-state":u.hasThumb?"visible":"hidden",...c,ref:m,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...i},onPointerDownCapture:a(r.onPointerDownCapture,e=>{const t=e.target.getBoundingClientRect(),r=e.clientX-t.left,s=e.clientY-t.top;u.onThumbPointerDown({x:r,y:s})}),onPointerUp:a(r.onPointerUp,u.onThumbPointerUp)})});xe.displayName=pe;var ge="ScrollAreaCorner",ve=e.forwardRef((e,t)=>{const r=G(ge,e.__scopeScrollArea),l=Boolean(r.scrollbarX&&r.scrollbarY);return"scroll"!==r.type&&l?s.jsx(je,{...e,ref:t}):null});ve.displayName=ge;var je=e.forwardRef((t,r)=>{const{__scopeScrollArea:l,...o}=t,a=G(ge,l),[i,c]=e.useState(0),[d,u]=e.useState(0),h=Boolean(i&&d);return Ae(a.scrollbarX,()=>{var e;const t=(null==(e=a.scrollbarX)?void 0:e.offsetHeight)||0;a.onCornerHeightChange(t),u(t)}),Ae(a.scrollbarY,()=>{var e;const t=(null==(e=a.scrollbarY)?void 0:e.offsetWidth)||0;a.onCornerWidthChange(t),c(t)}),h?s.jsx(n.div,{...o,ref:r,style:{width:i,height:d,position:"absolute",right:"ltr"===a.dir?0:void 0,left:"rtl"===a.dir?0:void 0,bottom:0,...t.style}}):null});function we(e){return e?parseInt(e,10):0}function be(e,t){const r=e/t;return isNaN(r)?0:r}function ye(e){const t=be(e.viewport,e.content),r=e.scrollbar.paddingStart+e.scrollbar.paddingEnd,s=(e.scrollbar.size-r)*t;return Math.max(s,18)}function Ne(e,t,r="ltr"){const s=ye(t),l=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,n=t.scrollbar.size-l,o=t.content-t.viewport,a=n-s,i=d(e,"ltr"===r?[0,o]:[-1*o,0]);return Se([0,o],[0,a])(i)}function Se(e,t){return r=>{if(e[0]===e[1]||t[0]===t[1])return t[0];const s=(t[1]-t[0])/(e[1]-e[0]);return t[0]+s*(r-e[0])}}function Ce(e,t){return e>0&&e<t}var Te=(e,t=()=>{})=>{let r={left:e.scrollLeft,top:e.scrollTop},s=0;return function l(){const n={left:e.scrollLeft,top:e.scrollTop},o=r.left!==n.left,a=r.top!==n.top;(o||a)&&t(),r=n,s=window.requestAnimationFrame(l)}(),()=>window.cancelAnimationFrame(s)};function Ee(t,r){const s=i(t),l=e.useRef(0);return e.useEffect(()=>()=>window.clearTimeout(l.current),[]),e.useCallback(()=>{window.clearTimeout(l.current),l.current=window.setTimeout(s,r)},[s,r])}function Ae(e,t){const r=i(t);c(()=>{let t=0;if(e){const s=new ResizeObserver(()=>{cancelAnimationFrame(t),t=window.requestAnimationFrame(r)});return s.observe(e),()=>{window.cancelAnimationFrame(t),s.unobserve(e)}}},[e,r])}var Re=ee,Le=re,ke=ve;function De({className:e,children:t,...r}){return s.jsxs(Re,{"data-slot":"scroll-area",className:m("relative",e),...r,children:[s.jsx(Le,{"data-slot":"scroll-area-viewport",className:"focus-visible:ring-ring/50 size-full rounded-[inherit] transition-[color,box-shadow] outline-none focus-visible:ring-[3px] focus-visible:outline-1",children:t}),s.jsx(Pe,{}),s.jsx(ke,{})]})}function Pe({className:e,orientation:t="vertical",...r}){return s.jsx(le,{"data-slot":"scroll-area-scrollbar",orientation:t,className:m("flex touch-none p-px transition-colors select-none","vertical"===t&&"h-full w-2.5 border-l border-l-transparent","horizontal"===t&&"h-2.5 flex-col border-t border-t-transparent",e),...r,children:s.jsx(xe,{"data-slot":"scroll-area-thumb",className:"bg-border relative flex-1 rounded-full"})})}function _e({open:t,onOpenChange:r}){const{selectedForComparison:l,getCalculationById:n,toggleComparisonSelection:o}=u(),a=e.useMemo(()=>l.map(e=>n(e)).filter(Boolean),[l,n]),i=e.useMemo(()=>{const e=new Set;return a.forEach(t=>{t&&(Object.keys(t.results).forEach(t=>e.add(t)),Object.keys(t.inputs).forEach(t=>e.add(`input_${t}`)))}),Array.from(e)},[a]),c=e=>null==e?"N/A":"number"==typeof e?Number.isInteger(e)?e.toLocaleString():e.toLocaleString(void 0,{maximumFractionDigits:2}):"boolean"==typeof e?e?"Yes":"No":e instanceof Date?e.toLocaleDateString():String(e),d=e=>(e.startsWith("input_")?e.substring(6):e).replace(/([A-Z])/g," $1").replace(/_/g," ").trim().split(" ").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" "),h=e=>e.startsWith("input_")?"input":"result",m=i.filter(e=>"input"===h(e)),N=i.filter(e=>"result"===h(e));return s.jsx(p,{open:t,onOpenChange:r,children:s.jsxs(x,{className:"max-w-6xl max-h-[90vh]",children:[s.jsxs(f,{children:[s.jsxs(g,{className:"flex items-center gap-2",children:[s.jsx(v,{className:"w-5 h-5"}),"Compare Calculations (",a.length,")"]}),s.jsx(j,{children:"Side-by-side comparison of your selected calculations"})]}),s.jsx(De,{className:"h-[calc(90vh-120px)] pr-4",children:s.jsxs("div",{className:"space-y-6",children:[s.jsx("div",{className:"grid gap-4",style:{gridTemplateColumns:`repeat(${Math.min(a.length,3)}, 1fr)`},children:a.slice(0,3).map(e=>{return e?s.jsxs(w,{className:"p-4 relative",children:[s.jsx(b,{variant:"ghost",size:"sm",className:"absolute top-2 right-2 h-8 w-8 p-0",onClick:()=>o(e.id),children:s.jsx(y,{className:"w-4 h-4"})}),s.jsxs("div",{className:"space-y-2 mb-4",children:[s.jsx("h3",{className:"font-semibold text-lg pr-8",children:e.calculatorName}),s.jsx(P,{variant:"outline",children:e.calculatorType}),s.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[s.jsx(F,{className:"w-3 h-3"}),(t=e.timestamp,new Date(t).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}))]})]})]},e.id):null;var t})}),a.length>3&&s.jsxs("div",{className:"text-center text-sm text-muted-foreground",children:["Showing first 3 of ",a.length," selected calculations"]}),s.jsx(U,{}),m.length>0&&s.jsxs("div",{children:[s.jsxs("h3",{className:"font-semibold text-lg mb-4 flex items-center gap-2",children:[s.jsx(Y,{className:"w-4 h-4"}),"Input Parameters"]}),s.jsx("div",{className:"space-y-2",children:m.map(e=>s.jsxs("div",{className:"grid gap-4 p-3 bg-muted/50 rounded-lg",style:{gridTemplateColumns:`200px repeat(${Math.min(a.length,3)}, 1fr)`},children:[s.jsx("div",{className:"font-medium text-sm flex items-center",children:d(e)}),a.slice(0,3).map(t=>{if(!t)return null;const r=e.substring(6),l=t.inputs[r];return s.jsx("div",{className:"text-sm",children:c(l)},t.id)})]},e))})]}),N.length>0&&s.jsxs("div",{children:[s.jsxs("h3",{className:"font-semibold text-lg mb-4 flex items-center gap-2",children:[s.jsx(v,{className:"w-4 h-4"}),"Results"]}),s.jsx("div",{className:"space-y-2",children:N.map(e=>{const t=a.slice(0,3).map(t=>null==t?void 0:t.results[e]),r=t.every(e=>"number"==typeof e)&&new Set(t).size>1;return s.jsxs("div",{className:"grid gap-4 p-3 rounded-lg "+(r?"bg-blue-50 dark:bg-blue-950/20 border border-blue-200 dark:border-blue-900":"bg-muted/50"),style:{gridTemplateColumns:`200px repeat(${Math.min(a.length,3)}, 1fr)`},children:[s.jsx("div",{className:"font-medium text-sm flex items-center",children:d(e)}),a.slice(0,3).map(t=>{if(!t)return null;const r=t.results[e];return s.jsx("div",{className:"text-sm font-semibold",children:c(r)},t.id)})]},e)})})]}),a.some(e=>null==e?void 0:e.notes)&&s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-lg mb-4",children:"Notes"}),s.jsx("div",{className:"grid gap-4",style:{gridTemplateColumns:`repeat(${Math.min(a.length,3)}, 1fr)`},children:a.slice(0,3).map(e=>e?s.jsx(w,{className:"p-4",children:e.notes?s.jsx("p",{className:"text-sm text-muted-foreground",children:e.notes}):s.jsx("p",{className:"text-sm text-muted-foreground italic",children:"No notes"})},e.id):null)})]})]})})]})})}function ze(){const{history:t,deleteCalculation:r,deleteMultiple:l,clearHistory:n,toggleFavorite:o,updateNotes:a,updateTags:i,toggleComparisonSelection:c,selectedForComparison:d,exportHistory:h}=u(),{toast:m}=N(),[y,U]=e.useState(""),[Y,K]=e.useState("all"),[J,Q]=e.useState(!1),[G,ee]=e.useState("recent"),[te,re]=e.useState([]),[se,le]=e.useState(!1),[ne,oe]=e.useState(!1),[ae,ie]=e.useState(null),[ce,de]=e.useState(!1),ue=e.useMemo(()=>{const e=new Set(t.map(e=>e.calculatorType));return Array.from(e).sort()},[t]),he=e.useMemo(()=>{let e=t;if(y){const t=y.toLowerCase();e=e.filter(e=>{var r,s;return e.calculatorName.toLowerCase().includes(t)||(null==(r=e.notes)?void 0:r.toLowerCase().includes(t))||(null==(s=e.tags)?void 0:s.some(e=>e.toLowerCase().includes(t)))})}"all"!==Y&&(e=e.filter(e=>e.calculatorType===Y)),J&&(e=e.filter(e=>e.favorite));return[...e].sort((e,t)=>"recent"===G?t.timestamp-e.timestamp:"oldest"===G?e.timestamp-t.timestamp:e.calculatorName.localeCompare(t.calculatorName))},[t,y,Y,J,G]);return s.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-background via-background to-muted/20",children:[s.jsxs("div",{className:"container mx-auto px-4 py-8 max-w-7xl",children:[s.jsxs("div",{className:"mb-8",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx(S,{className:"w-8 h-8 text-primary"}),s.jsx("h1",{className:"text-4xl font-bold",children:"Calculation History"})]}),s.jsx("p",{className:"text-muted-foreground",children:"View, compare, and manage all your saved calculations"})]}),s.jsxs("div",{className:"mb-6 space-y-4",children:[s.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[s.jsxs("div",{className:"relative flex-1",children:[s.jsx(C,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-muted-foreground"}),s.jsx(T,{placeholder:"Search calculations, notes, or tags...",value:y,onChange:e=>U(e.target.value),className:"pl-10"})]}),s.jsxs(z,{value:Y,onValueChange:e=>K(e),children:[s.jsxs(O,{className:"w-full md:w-[200px]",children:[s.jsx(X,{className:"w-4 h-4 mr-2"}),s.jsx(H,{placeholder:"Filter by type"})]}),s.jsxs(M,{children:[s.jsx(I,{value:"all",children:"All Types"}),ue.map(e=>s.jsx(I,{value:e,children:e.split("-").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ")},e))]})]}),s.jsxs(z,{value:G,onValueChange:e=>ee(e),children:[s.jsx(O,{className:"w-full md:w-[180px]",children:s.jsx(H,{placeholder:"Sort by"})}),s.jsxs(M,{children:[s.jsx(I,{value:"recent",children:"Most Recent"}),s.jsx(I,{value:"oldest",children:"Oldest First"}),s.jsx(I,{value:"name",children:"Name (A-Z)"})]})]})]}),s.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[s.jsxs(b,{variant:J?"default":"outline",size:"sm",onClick:()=>Q(!J),children:[s.jsx(B,{className:"w-4 h-4 mr-2 "+(J?"fill-current":"")}),"Favorites Only"]}),te.length>0&&s.jsxs(s.Fragment,{children:[s.jsxs(b,{variant:"outline",size:"sm",onClick:()=>le(!0),children:[s.jsx($,{className:"w-4 h-4 mr-2"}),"Delete (",te.length,")"]}),s.jsx(b,{variant:"outline",size:"sm",onClick:()=>re([]),children:"Clear Selection"})]}),s.jsxs("div",{className:"ml-auto flex gap-2",children:[d.length>=2&&s.jsxs(b,{variant:"default",size:"sm",onClick:()=>de(!0),children:[s.jsx(v,{className:"w-4 h-4 mr-2"}),"Compare (",d.length,")"]}),s.jsxs(b,{variant:"outline",size:"sm",onClick:()=>{try{const e=h(),r=`data:application/json;charset=utf-8,${encodeURIComponent(e)}`,s=`calculator-history-${(new Date).toISOString().split("T")[0]}.json`,l=document.createElement("a");l.setAttribute("href",r),l.setAttribute("download",s),l.click(),m({title:"History exported!",description:`${t.length} calculations exported successfully.`})}catch(e){m({title:"Export failed",description:"Failed to export history. Please try again.",variant:"destructive"})}},children:[s.jsx(E,{className:"w-4 h-4 mr-2"}),"Export"]}),t.length>0&&s.jsx(b,{variant:"destructive",size:"sm",onClick:()=>oe(!0),children:"Clear All"})]})]})]}),he.length>0&&s.jsxs("div",{className:"mb-4 flex items-center gap-2",children:[s.jsx(_,{checked:te.length===he.length&&he.length>0,onCheckedChange:()=>{te.length===he.length?re([]):re(he.map(e=>e.id))}}),s.jsxs("span",{className:"text-sm text-muted-foreground",children:["Select All (",he.length," results)"]})]}),0===he.length?s.jsxs(w,{className:"p-12 text-center",children:[s.jsx(S,{className:"w-16 h-16 mx-auto mb-4 text-muted-foreground"}),s.jsx("h3",{className:"text-xl font-semibold mb-2",children:"No calculations found"}),s.jsx("p",{className:"text-muted-foreground",children:0===t.length?"Start using calculators to build your history":"Try adjusting your filters or search query"})]}):s.jsx("div",{className:"grid gap-4",children:he.map(e=>{return s.jsx(w,{className:"p-4 hover:shadow-lg transition-shadow",children:s.jsxs("div",{className:"flex items-start gap-4",children:[s.jsx(_,{checked:te.includes(e.id),onCheckedChange:()=>{return t=e.id,void re(e=>e.includes(t)?e.filter(e=>e!==t):[...e,t]);var t}}),s.jsxs("div",{className:"flex-1 space-y-3",children:[s.jsxs("div",{className:"flex items-start justify-between gap-4",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx("h3",{className:"text-lg font-semibold",children:e.calculatorName}),s.jsx(P,{variant:"outline",className:"text-xs",children:e.calculatorType}),e.favorite&&s.jsx(B,{className:"w-4 h-4 fill-yellow-400 text-yellow-400"})]}),s.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[s.jsx(F,{className:"w-3 h-3"}),(l=e.timestamp,new Date(l).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}))]})]}),s.jsxs(A,{children:[s.jsx(R,{asChild:!0,children:s.jsx(b,{variant:"ghost",size:"sm",children:s.jsx(Z,{className:"w-4 h-4"})})}),s.jsxs(L,{align:"end",children:[s.jsxs(k,{onClick:()=>o(e.id),children:[s.jsx(B,{className:"w-4 h-4 mr-2"}),e.favorite?"Unfavorite":"Favorite"]}),s.jsxs(k,{onClick:()=>ie(e),children:[s.jsx(V,{className:"w-4 h-4 mr-2"}),"Edit Notes"]}),s.jsxs(k,{onClick:()=>c(e.id),children:[s.jsx(v,{className:"w-4 h-4 mr-2"}),d.includes(e.id)?"Remove from Comparison":"Add to Comparison"]}),s.jsxs(k,{onClick:()=>r(e.id),className:"text-destructive",children:[s.jsx($,{className:"w-4 h-4 mr-2"}),"Delete"]})]})]})]}),s.jsx("div",{className:"grid md:grid-cols-2 gap-4 p-3 bg-muted/50 rounded-lg",children:(t=e.results,Object.entries(t).slice(0,3).map(([e,t])=>{const r=e.replace(/([A-Z])/g," $1").trim();return s.jsxs("div",{className:"text-sm",children:[s.jsxs("span",{className:"text-muted-foreground",children:[r,":"]})," ",s.jsx("span",{className:"font-medium",children:String(t)})]},e)}))}),e.notes&&s.jsx("div",{className:"p-3 bg-blue-50 dark:bg-blue-950/20 rounded-lg border border-blue-200 dark:border-blue-900",children:s.jsx("p",{className:"text-sm",children:e.notes})}),e.tags&&e.tags.length>0&&s.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[s.jsx(q,{className:"w-3 h-3 text-muted-foreground"}),e.tags.map((e,t)=>s.jsx(P,{variant:"secondary",className:"text-xs",children:e},t))]})]})]})},e.id);var t,l})})]}),s.jsx(p,{open:se,onOpenChange:le,children:s.jsxs(x,{children:[s.jsxs(f,{children:[s.jsx(g,{children:"Delete Selected Calculations"}),s.jsxs(j,{children:["Are you sure you want to delete ",te.length," calculation(s)? This action cannot be undone."]})]}),s.jsxs(D,{children:[s.jsx(b,{variant:"outline",onClick:()=>le(!1),children:"Cancel"}),s.jsx(b,{variant:"destructive",onClick:()=>{te.length>0&&(l(te),re([]),le(!1))},children:"Delete"})]})]})}),s.jsx(p,{open:ne,onOpenChange:oe,children:s.jsxs(x,{children:[s.jsxs(f,{children:[s.jsx(g,{children:"Clear All History"}),s.jsx(j,{children:"Are you sure you want to delete all calculation history? This action cannot be undone."})]}),s.jsxs(D,{children:[s.jsx(b,{variant:"outline",onClick:()=>oe(!1),children:"Cancel"}),s.jsx(b,{variant:"destructive",onClick:()=>{n(),re([]),oe(!1)},children:"Clear All"})]})]})}),s.jsx(p,{open:!!ae,onOpenChange:e=>!e&&ie(null),children:s.jsxs(x,{children:[s.jsxs(f,{children:[s.jsx(g,{children:"Edit Notes"}),s.jsx(j,{children:"Add notes to help you remember this calculation"})]}),ae&&s.jsx("div",{className:"space-y-4",children:s.jsx(W,{placeholder:"Add your notes here...",defaultValue:ae.notes||"",id:"notes-input",rows:4})}),s.jsxs(D,{children:[s.jsx(b,{variant:"outline",onClick:()=>ie(null),children:"Cancel"}),s.jsx(b,{onClick:()=>{var e;const t=null==(e=document.getElementById("notes-input"))?void 0:e.value;ae&&((e,t)=>{a(e,t),ie(null)})(ae.id,t)},children:"Save"})]})]})}),s.jsx(_e,{open:ce,onOpenChange:de})]})}export{ze as default};
